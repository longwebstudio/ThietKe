import{aE as de,aF as H,aq as te,r as N,C as ie,at as ce,ar as le,D as R,as as fe,aG as ve,E as F,i as B,w as P,f as $,G as oe,I as x,av as j,aH as W,P as ue,ao as pe,aI as he,H as ge,a0 as me,y as ye,S as be,ay as xe,d as O,g as G,n as V,L as Ce,F as ae,a1 as ne,a2 as ke,e as re,a4 as Te,t as Ie}from"./BZOcpPos.js";import{c as Ke}from"./BJfEUSIJ.js";import Se from"./C7y0ML9J.js";import{_ as Ee,M as Ae,a as we}from"./BsvtvfBH.js";import{u as _e}from"./Cjp9tGA2.js";import"./Yby765Ga.js";function se(r,a,e){const c=e.originalEvent.target,T=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:e});a&&c.addEventListener(r,a,{once:!0}),c.dispatchEvent(T)}function Ve(r){const a=de("",1e3);return{search:a,handleTypeaheadSearch:(T,l)=>{a.value=a.value+T;{const f=H(),v=l.map(y=>{var E,L;return{...y,textValue:((E=y.value)==null?void 0:E.textValue)??((L=y.ref.textContent)==null?void 0:L.trim())??""}}),i=v.find(y=>y.ref===f),m=v.map(y=>y.textValue),A=Re(m,a.value,i==null?void 0:i.textValue),C=v.find(y=>y.textValue===A);return C&&C.ref.focus(),C==null?void 0:C.ref}},resetTypeahead:()=>{a.value=""}}}function Be(r,a){return r.map((e,c)=>r[(a+c)%r.length])}function Re(r,a,e){const T=a.length>1&&Array.from(a).every(m=>m===a[0])?a[0]:a,l=e?r.indexOf(e):-1;let f=Be(r,Math.max(l,0));T.length===1&&(f=f.filter(m=>m!==e));const i=f.find(m=>m.toLowerCase().startsWith(T.toLowerCase()));return i!==e?i:void 0}function Y(r,a,e){const c=r.findIndex(v=>te(v,a)),T=r.findIndex(v=>te(v,e));if(c===-1||T===-1)return[];const[l,f]=[c,T].sort((v,i)=>v-i);return r.slice(l,f+1)}function U(r){return r.reduce((a,e)=>(a.push(e),e.children&&a.push(...U(e.children)),a),[])}function Le(r,a){const e=N(),c=(l,f)=>{if(a.multiple&&Array.isArray(r.value))if(a.selectionBehavior==="replace")r.value=[l],e.value=l;else{const v=r.value.findIndex(i=>f(i));v!==-1?r.value=r.value.filter((i,m)=>m!==v):r.value=[...r.value,l]}else a.selectionBehavior==="replace"?r.value={...l}:!Array.isArray(r.value)&&f(r.value)?r.value=void 0:r.value={...l};return r.value};function T(l,f,v,i){var y;if(!(e!=null&&e.value)||!a.multiple||!Array.isArray(r.value))return;const A=(y=v().filter(E=>E.ref.dataset.disabled!=="").find(E=>E.ref===f))==null?void 0:y.value;if(!A)return;let C=null;switch(l){case"prev":case"next":{C=Y(i,e.value,A);break}case"first":{C=Y(i,e.value,i==null?void 0:i[0]);break}case"last":{C=Y(i,e.value,i==null?void 0:i[i.length-1]);break}}r.value=C}return{firstValue:e,onSelectItem:c,handleMultipleReplace:T}}const[$e,Me]=fe("TreeRoot"),Pe=ie({__name:"TreeRoot",props:{modelValue:{},defaultValue:{},items:{},expanded:{},defaultExpanded:{},getKey:{},getChildren:{type:Function,default:r=>r.children},selectionBehavior:{default:"toggle"},multiple:{},dir:{},disabled:{type:Boolean},propagateSelect:{type:Boolean},bubbleSelect:{type:Boolean},asChild:{type:Boolean},as:{default:"ul"}},emits:["update:modelValue","update:expanded"],setup(r,{emit:a}){const e=r,c=a,{items:T,multiple:l,disabled:f,propagateSelect:v,dir:i,bubbleSelect:m}=ce(e),{handleTypeaheadSearch:A}=Ve(),C=_e(i),y=N(),E=N(!1),L=ve(),n=le(e,"modelValue",c,{defaultValue:e.defaultValue??(l.value?[]:void 0),passive:e.modelValue===void 0,deep:!0}),o=le(e,"expanded",c,{defaultValue:e.defaultExpanded??[],passive:e.expanded===void 0,deep:!0}),{onSelectItem:t,handleMultipleReplace:s}=Le(n,e),u=R(()=>l.value&&Array.isArray(n.value)?n.value.map(d=>e.getKey(d)):[e.getKey(n.value??{})]);function p(d,g=1,b){return d.reduce((S,k,_)=>{const M=e.getKey(k),D=e.getChildren(k),q=o.value.includes(M),z={_id:M,value:k,index:_,level:g,parentItem:b,hasChildren:!!D,bind:{value:k,level:g,"aria-setsize":d.length,"aria-posinset":_+1}};return S.push(z),D&&q&&S.push(...p(D,g+1,k)),S},[])}const h=R(()=>{const d=e.items;return o.value.map(g=>g),p(d??[])});function K(d){var g;if(E.value)L.trigger(d);else{const b=((g=y.value)==null?void 0:g.getItems())??[];A(d.key,b)}}function I(d){if(E.value)return;const g=Ae[d.key];pe(()=>{var b;s(g,H(),(b=y.value)==null?void 0:b.getItems,h.value.map(S=>S.value))})}function w(d){var g;if(d.parentItem!=null&&Array.isArray(n.value)&&e.multiple){const b=h.value.find(S=>d.parentItem!=null&&e.getKey(S.value)===e.getKey(d.parentItem));b!=null&&(((g=e.getChildren(b.value))==null?void 0:g.every(k=>n.value.find(_=>e.getKey(_)===e.getKey(k))))?n.value=[...n.value,b.value]:n.value=n.value.filter(k=>e.getKey(k)!==e.getKey(b.value)),w(b))}}return Me({modelValue:n,selectedKeys:u,onSelect:d=>{var S;const g=k=>e.getKey(k??{})===e.getKey(d),b=e.multiple&&Array.isArray(n.value)?((S=n.value)==null?void 0:S.findIndex(g))!==-1:void 0;if(t(d,g),e.bubbleSelect&&e.multiple&&Array.isArray(n.value)){const k=h.value.find(_=>e.getKey(_.value)===e.getKey(d));k!=null&&w(k)}if(e.propagateSelect&&e.multiple&&Array.isArray(n.value)){const k=U(e.getChildren(d)??[]);b?n.value=[...n.value].filter(_=>!k.some(M=>e.getKey(_??{})===e.getKey(M))):n.value=[...n.value,...k]}},expanded:o,onToggle(d){if(!(d?e.getChildren(d):void 0))return;const b=e.getKey(d)??d;o.value.includes(b)?o.value=o.value.filter(S=>S!==b):o.value.push(b)},getKey:e.getKey,getChildren:e.getChildren,items:T,expandedItems:h,disabled:f,multiple:l,dir:C,propagateSelect:v,bubbleSelect:m,isVirtual:E,virtualKeydownHook:L,handleMultipleReplace:s}),(d,g)=>(B(),F(x(Ee),{ref_key:"rovingFocusGroupRef",ref:y,"as-child":"",orientation:"vertical",dir:x(C)},{default:P(()=>[$(x(ue),{role:"tree",as:d.as,"as-child":d.asChild,"aria-multiselectable":x(l)?!0:void 0,onKeydown:[K,j(W(I,["shift"]),["up","down"])]},{default:P(()=>[oe(d.$slots,"default",{flattenItems:h.value,modelValue:x(n),expanded:x(o)})]),_:3},8,["as","as-child","aria-multiselectable","onKeydown"])]),_:3},8,["dir"]))}}),De="tree.select",Ne="tree.toggle",Oe=ie({inheritAttrs:!1,__name:"TreeItem",props:{value:{},level:{},asChild:{type:Boolean},as:{default:"li"}},emits:["select","toggle"],setup(r,{expose:a,emit:e}){const c=r,T=e,l=$e(),{getItems:f}=he(),v=R(()=>!!l.getChildren(c.value)),i=R(()=>{const t=l.getKey(c.value);return l.expanded.value.includes(t)}),m=R(()=>{const t=l.getKey(c.value);return l.selectedKeys.value.includes(t)}),A=R(()=>{if(l.bubbleSelect.value&&v.value&&Array.isArray(l.modelValue.value)){const t=U(l.getChildren(c.value)||[]);return t.some(s=>l.modelValue.value.find(u=>l.getKey(u)===l.getKey(s)))&&!t.every(s=>l.modelValue.value.find(u=>l.getKey(u)===l.getKey(s)))}else return l.propagateSelect.value&&m.value&&v.value&&Array.isArray(l.modelValue.value)?!U(l.getChildren(c.value)||[]).every(s=>l.modelValue.value.find(u=>l.getKey(u)===l.getKey(s))):void 0});function C(t){if(v.value)if(i.value){const s=f().map(I=>I.ref),u=H(),p=s.indexOf(u),K=[...s].slice(p).find(I=>Number(I.getAttribute("data-indent"))===c.level+1);K&&K.focus()}else o(t)}function y(t){if(i.value)o(t);else{const s=f().map(I=>I.ref),u=H(),p=s.indexOf(u),K=[...s].slice(0,p).reverse().find(I=>Number(I.getAttribute("data-indent"))===c.level-1);K&&K.focus()}}async function E(t){T("select",t),!(t!=null&&t.defaultPrevented)&&l.onSelect(c.value)}async function L(t){T("toggle",t),!(t!=null&&t.defaultPrevented)&&l.onToggle(c.value)}async function n(t){if(!t)return;const s={originalEvent:t,value:c.value,isExpanded:i.value,isSelected:m.value};se(De,E,s)}async function o(t){if(!t)return;const s={originalEvent:t,value:c.value,isExpanded:i.value,isSelected:m.value};se(Ne,L,s)}return a({isExpanded:i,isSelected:m,isIndeterminate:A,handleToggle:()=>l.onToggle(c.value),handleSelect:()=>l.onSelect(c.value)}),(t,s)=>(B(),F(x(we),{"as-child":"",value:t.value,"allow-shift-key":""},{default:P(()=>[$(x(ue),ge(t.$attrs,{role:"treeitem",as:t.as,"as-child":t.asChild,"aria-selected":m.value,"aria-expanded":v.value?i.value:void 0,"aria-level":t.level,"data-indent":t.level,"data-selected":m.value?"":void 0,"data-expanded":i.value?"":void 0,onKeydown:[j(W(n,["self","prevent"]),["enter","space"]),s[0]||(s[0]=j(W(u=>x(l).dir.value==="ltr"?C(u):y(u),["prevent"]),["right"])),s[1]||(s[1]=j(W(u=>x(l).dir.value==="ltr"?y(u):C(u),["prevent"]),["left"]))],onClick:s[2]||(s[2]=W(u=>{n(u),o(u)},["stop"]))}),{default:P(()=>[oe(t.$slots,"default",{isExpanded:i.value,isSelected:m.value,isIndeterminate:A.value,handleSelect:()=>x(l).onSelect(t.value),handleToggle:()=>x(l).onToggle(t.value)})]),_:3},16,["as","as-child","aria-selected","aria-expanded","aria-level","data-indent","data-selected","data-expanded","onKeydown"])]),_:3},8,["value"]))}}),We={slots:{root:"relative lg:h-[450px] my-5 grid lg:grid-cols-3 border border-muted rounded-md",list:"isolate relative p-2 border-b lg:border-b-0 lg:border-e border-muted overflow-y-auto",item:"",listWithChildren:"ms-4.5 border-s border-default",itemWithChildren:"ps-1.5 -ms-px",link:"relative group peer w-full px-2.5 py-1.5 before:inset-y-px before:inset-x-0 flex items-center gap-1.5 text-sm before:absolute before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2",linkLeadingIcon:"size-4 shrink-0",linkLabel:"truncate",linkTrailing:"ms-auto inline-flex gap-1.5 items-center",linkTrailingIcon:"size-5 transform transition-transform duration-200 shrink-0 group-data-expanded:rotate-180",content:"overflow-hidden lg:col-span-2 flex flex-col [&>div]:my-0 [&>div]:flex-1 [&>div]:flex [&>div]:flex-col [&>div>div]:border-0 [&>div>pre]:border-b-0 [&>div>pre]:border-s-0 [&>div>pre]:border-e-0 [&>div>pre]:rounded-l-none [&>div>pre]:flex-1 [&>div]:overflow-y-auto"},variants:{active:{true:{link:"text-highlighted before:bg-elevated"},false:{link:["hover:text-highlighted hover:before:bg-elevated/50","transition-colors before:transition-colors"]}}}},Ue={__name:"ProseCodeTree",props:{defaultValue:{type:String,required:!1},expandAll:{type:Boolean,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1}},setup(r){const a=r,e=me(),c=ye(),[T,l]=Ke(),f=R(()=>{var n,o;return ne({extend:ne(We),...((o=(n=c.uiPro)==null?void 0:n.prose)==null?void 0:o.codeTree)||{}})()}),v=N(a.defaultValue?{path:a.defaultValue}:void 0),i=N(),m=N(1),A=R(()=>{var n,o;return m.value,((o=(n=e.default)==null?void 0:n.call(e))==null?void 0:o.flatMap(E).filter(Boolean))||[]}),C=R(()=>y(A.value));function y(n){const o=new Map,t=[];n.forEach(u=>{const p=u.label.split("/");let h="";p.forEach((K,I)=>{var w,d;if(h=h?`${h}/${K}`:K,!o.has(h)){const g={label:K,path:h,...I<p.length-1&&{children:[]}};o.set(h,g),I===0?t.push(g):(d=(w=o.get(p.slice(0,I).join("/")))==null?void 0:w.children)==null||d.push(g)}})});const s=u=>u.sort((p,h)=>!!p.children==!!h.children?p.label.localeCompare(h.label):h.children?1:-1).map(p=>({...p,children:p.children&&s(p.children)}));return s(t)}function E(n,o){var t,s,u,p;return typeof n.type=="symbol"?(t=n.children)==null?void 0:t.map(E):{label:((s=n.props)==null?void 0:s.filename)||((u=n.props)==null?void 0:u.label)||`${o}`,icon:(p=n.props)==null?void 0:p.icon,component:n}}const L=R(()=>{var t;if(a.expandAll){const s=new Set;return A.value.forEach(u=>{const p=u.label.split("/");for(let h=1;h<p.length;h++)s.add(p.slice(0,h).join("/"))}),Array.from(s)}const n=(t=v.value)==null?void 0:t.path;if(!n)return[];const o=n.split("/");return o.map((s,u)=>o.slice(0,u+1).join("/"))});return be(v,n=>{const o=A.value.find(t=>(n==null?void 0:n.path)===t.label);o!=null&&o.component&&(i.value=o)},{immediate:!0}),xe(()=>m.value++),(n,o)=>{var s,u,p,h;const t=Te;return B(),O(ae,null,[$(x(T),null,{default:P(({items:K,level:I})=>[(B(!0),O(ae,null,ke(K,(w,d)=>{var g,b;return B(),O("li",{key:`${I}-${d}`,class:V(I>0?f.value.itemWithChildren({class:(g=a.ui)==null?void 0:g.itemWithChildren}):f.value.item({class:(b=a.ui)==null?void 0:b.item}))},[$(x(Oe),{"as-child":"",level:I,value:w},{default:P(({isExpanded:S,isSelected:k})=>{var _,M,D,q,z,J,Q,X,Z,ee;return[G("button",{class:V(f.value.link({class:(_=a.ui)==null?void 0:_.link,active:k}))},[(M=w.children)!=null&&M.length?(B(),F(t,{key:0,name:S?x(c).ui.icons.folderOpen:x(c).ui.icons.folder,class:V(f.value.linkLeadingIcon({class:(D=a.ui)==null?void 0:D.linkLeadingIcon}))},null,8,["name","class"])):(B(),F(Se,{key:1,filename:w.label,class:V(f.value.linkLeadingIcon({class:(q=a.ui)==null?void 0:q.linkLeadingIcon}))},null,8,["filename","class"])),G("span",{class:V(f.value.linkLabel({class:(z=a.ui)==null?void 0:z.linkLabel}))},Ie(w.label),3),(J=w.children)!=null&&J.length?(B(),O("span",{key:2,class:V(f.value.linkTrailing({class:(Q=a.ui)==null?void 0:Q.linkTrailing}))},[$(t,{name:x(c).ui.icons.chevronDown,class:V(f.value.linkTrailingIcon({class:(X=a.ui)==null?void 0:X.linkTrailingIcon}))},null,8,["name","class"])],2)):re("",!0)],2),(Z=w.children)!=null&&Z.length&&S?(B(),O("ul",{key:0,class:V(f.value.listWithChildren({class:(ee=a.ui)==null?void 0:ee.listWithChildren}))},[$(x(l),{items:w.children,level:I+1},null,8,["items","level"])],2)):re("",!0)]}),_:2},1032,["level","value"])],2)}),128))]),_:1}),G("div",{class:V(f.value.root({class:[(s=a.ui)==null?void 0:s.root,a.class]}))},[$(x(Pe),{modelValue:v.value,"onUpdate:modelValue":o[0]||(o[0]=K=>v.value=K),class:V(f.value.list({class:(u=a.ui)==null?void 0:u.list})),items:C.value,"get-key":K=>K.path,"default-expanded":L.value},{default:P(()=>[$(x(l),{items:C.value,level:0},null,8,["items"])]),_:1},8,["modelValue","class","items","get-key","default-expanded"]),G("div",{class:V(f.value.content({class:(p=a.ui)==null?void 0:p.content}))},[(B(),F(Ce((h=i.value)==null?void 0:h.component)))],2)],2)],64)}}};export{Ue as default};
